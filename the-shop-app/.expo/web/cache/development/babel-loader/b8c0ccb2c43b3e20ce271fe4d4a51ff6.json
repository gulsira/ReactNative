{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nvar _jsxFileName = \"C:\\\\Users\\\\gulsi\\\\Desktop\\\\NodeReact\\\\React Native\\\\the-shop-app\\\\screens\\\\user\\\\EditProductScreen.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useCallback, useEffect, useReducer, useState } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport { HeaderButtons, Item } from 'react-navigation-header-buttons';\nimport { useSelector, useDispatch } from 'react-redux';\nimport HeaderButton from \"../../components/UI/HeaderButton\";\nimport * as productsActions from \"../../store/actions/products\";\nimport Input from \"../../components/UI/Input\";\nimport Colors from \"../../constants/Colors\";\nvar FORM_INPUT_UPDATE = 'FORM_INPUT_UPDATE';\n\nvar formReducer = function formReducer(state, action) {\n  if (action.type === FORM_INPUT_UPDATE) {\n    var updatedValues = _objectSpread({}, state.inputValues, _defineProperty({}, action.input, action.value));\n\n    var updatedValidities = _objectSpread({}, state.inputValidities, _defineProperty({}, action.input, action.isValid));\n\n    var updatedFormIsValid = true;\n\n    for (var key in updatedValidities) {\n      updatedFormIsValid = updatedFormIsValid && updatedValidities[key];\n    }\n\n    return {\n      formIsValid: updatedFormIsValid,\n      inputValidities: updatedValidities,\n      inputValues: updatedValues\n    };\n  }\n\n  ;\n  return state;\n};\n\nvar EditProductScreen = function EditProductScreen(props) {\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var _useState3 = useState(),\n      _useState4 = _slicedToArray(_useState3, 2),\n      error = _useState4[0],\n      setError = _useState4[1];\n\n  var prodId = props.navigation.getParam('productId');\n  var editedProduct = useSelector(function (state) {\n    return state.products.userProducts.find(function (prod) {\n      return prod.id === prodId;\n    });\n  });\n  var dispatch = useDispatch();\n\n  var _useReducer = useReducer(formReducer, {\n    inputValues: {\n      title: editedProduct ? editedProduct.title : '',\n      imageUrl: editedProduct ? editedProduct.imageUrl : '',\n      description: editedProduct ? editedProduct.description : '',\n      price: ''\n    },\n    inputValidities: {\n      title: editedProduct ? true : false,\n      imageUrl: editedProduct ? true : false,\n      description: editedProduct ? true : false,\n      price: editedProduct ? true : false\n    },\n    formIsValid: editedProduct ? true : false\n  }),\n      _useReducer2 = _slicedToArray(_useReducer, 2),\n      formState = _useReducer2[0],\n      dispatchFormState = _useReducer2[1];\n\n  useEffect(function () {\n    if (error) {\n      Alert.alert('An error occured', error, [{\n        text: 'Okay'\n      }]);\n    }\n  }, [error]);\n  var submitHandler = useCallback(function _callee() {\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (formState.formIsValid) {\n              _context.next = 3;\n              break;\n            }\n\n            Alert.alert('Wrong input', 'Please check the errors in the form', [{\n              text: 'Okay'\n            }]);\n            return _context.abrupt(\"return\");\n\n          case 3:\n            setError(null);\n            setIsLoading(true);\n            _context.prev = 5;\n\n            if (!editedProduct) {\n              _context.next = 11;\n              break;\n            }\n\n            _context.next = 9;\n            return _regeneratorRuntime.awrap(dispatch(productsActions.updateProduct(prodId, formState.inputValues.title, formState.inputValues.description, formState.inputValues.imageUrl)));\n\n          case 9:\n            _context.next = 13;\n            break;\n\n          case 11:\n            _context.next = 13;\n            return _regeneratorRuntime.awrap(dispatch(productsActions.createProduct(formState.inputValues.title, formState.inputValues.description, formState.inputValues.imageUrl, +formState.inputValues.price)));\n\n          case 13:\n            props.navigation.goBack();\n            _context.next = 19;\n            break;\n\n          case 16:\n            _context.prev = 16;\n            _context.t0 = _context[\"catch\"](5);\n            setError(_context.t0.message);\n\n          case 19:\n            setIsLoading(false);\n\n          case 20:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[5, 16]], Promise);\n  }, [dispatch, prodId, formState]);\n  useEffect(function () {\n    props.navigation.setParams({\n      submit: submitHandler\n    });\n  }, [submitHandler]);\n  var inputChangedHandler = useCallback(function (inputIdentifier, inputValue, inputValidity) {\n    dispatchFormState({\n      type: FORM_INPUT_UPDATE,\n      value: inputValue,\n      isValid: inputValidity,\n      input: inputIdentifier\n    });\n  }, [dispatchFormState]);\n\n  if (isLoading) {\n    return React.createElement(View, {\n      style: styles.centered,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 12\n      }\n    }, React.createElement(ActivityIndicator, {\n      size: \"large\",\n      color: Colors.primary,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 42\n      }\n    }));\n  }\n\n  return React.createElement(KeyboardAvoidingView, {\n    style: {\n      flex: 1\n    },\n    behavior: \"padding\",\n    keyboardVerticalOffset: 100,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 5\n    }\n  }, React.createElement(ScrollView, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }\n  }, React.createElement(View, {\n    style: styles.form,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 9\n    }\n  }, React.createElement(Input, {\n    id: \"title\",\n    label: \"Title\",\n    errorText: \"Please enter a valid title!\",\n    keyboardType: \"default\",\n    autoCapitalize: \"sentences\",\n    autoCorrect: true,\n    returnKeyType: \"next\",\n    onInputChange: inputChangedHandler,\n    initialValue: editedProduct ? editedProduct.title : '',\n    initiallyValid: !!editedProduct,\n    required: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 11\n    }\n  }), React.createElement(Input, {\n    id: \"imageUrl\",\n    label: \"Image Url\",\n    errorText: \"Please enter a valid image URL!\",\n    keyboardType: \"default\",\n    returnKeyType: \"next\",\n    onInputChange: inputChangedHandler,\n    initialValue: editedProduct ? editedProduct.imageUrl : '',\n    initiallyValid: !!editedProduct,\n    required: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 11\n    }\n  }), editedProduct ? null : React.createElement(Input, {\n    id: \"price\",\n    label: \"Price\",\n    errorText: \"Please enter a valid price!\",\n    keyboardType: \"decimal-pad\",\n    returnKeyType: \"next\",\n    onInputChange: inputChangedHandler,\n    required: true,\n    min: 0.1,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }\n  }), React.createElement(Input, {\n    id: \"description\",\n    label: \"Description\",\n    errorText: \"Please enter a valid description!\",\n    keyboardType: \"default\",\n    autoCapitalize: \"sentences\",\n    onInputChange: inputChangedHandler,\n    autoCorrect: true,\n    multiline: true,\n    numberOfLines: 3,\n    initialValue: editedProduct ? editedProduct.description : '',\n    initiallyValid: !!editedProduct,\n    required: true,\n    minLength: 5,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 11\n    }\n  }))));\n};\n\nEditProductScreen.navigationOptions = function (navData) {\n  var submitFn = navData.navigation.getParam('submit');\n  return {\n    headerTitle: navData.navigation.getParam('productId') ? 'Edit Product' : 'Add Product',\n    headerRight: function headerRight() {\n      return React.createElement(HeaderButtons, {\n        HeaderButtonComponent: HeaderButton,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 7\n        }\n      }, React.createElement(Item, {\n        title: \"Save\",\n        iconName: Platform.OS === 'android' ? 'md-checkmark' : 'ios-checkmark',\n        onPress: submitFn,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 9\n        }\n      }));\n    }\n  };\n};\n\nvar styles = StyleSheet.create({\n  form: {\n    margin: 20\n  },\n  centered: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center'\n  }\n});\nexport default EditProductScreen;","map":{"version":3,"sources":["C:/Users/gulsi/Desktop/NodeReact/React Native/the-shop-app/screens/user/EditProductScreen.js"],"names":["React","useCallback","useEffect","useReducer","useState","HeaderButtons","Item","useSelector","useDispatch","HeaderButton","productsActions","Input","Colors","FORM_INPUT_UPDATE","formReducer","state","action","type","updatedValues","inputValues","input","value","updatedValidities","inputValidities","isValid","updatedFormIsValid","key","formIsValid","EditProductScreen","props","isLoading","setIsLoading","error","setError","prodId","navigation","getParam","editedProduct","products","userProducts","find","prod","id","dispatch","title","imageUrl","description","price","formState","dispatchFormState","Alert","alert","text","submitHandler","updateProduct","createProduct","goBack","message","setParams","submit","inputChangedHandler","inputIdentifier","inputValue","inputValidity","styles","centered","primary","flex","form","navigationOptions","navData","submitFn","headerTitle","headerRight","Platform","OS","StyleSheet","create","margin","justifyContent","alignItems"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAcC,WAAd,EAA0BC,SAA1B,EAAoCC,UAApC,EAA+CC,QAA/C,QAA8D,OAA9D;;;;;;;;AAEA,SAASC,aAAT,EAAwBC,IAAxB,QAAoC,iCAApC;AACA,SAAQC,WAAR,EAAoBC,WAApB,QAAsC,aAAtC;AAEA,OAAOC,YAAP;AACA,OAAO,KAAKC,eAAZ;AACA,OAAOC,KAAP;AACA,OAAOC,MAAP;AAEA,IAAMC,iBAAiB,GAAG,mBAA1B;;AAEA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,KAAD,EAAQC,MAAR,EAAmB;AACrC,MAAGA,MAAM,CAACC,IAAP,KAAgBJ,iBAAnB,EAAuC;AACrC,QAAMK,aAAa,qBACdH,KAAK,CAACI,WADQ,sBAEhBH,MAAM,CAACI,KAFS,EAEDJ,MAAM,CAACK,KAFN,EAAnB;;AAIA,QAAMC,iBAAiB,qBAClBP,KAAK,CAACQ,eADY,sBAEpBP,MAAM,CAACI,KAFa,EAELJ,MAAM,CAACQ,OAFF,EAAvB;;AAIA,QAAIC,kBAAkB,GAAG,IAAzB;;AACA,SAAI,IAAMC,GAAV,IAAiBJ,iBAAjB,EAAoC;AAClCG,MAAAA,kBAAkB,GAAGA,kBAAkB,IAAGH,iBAAiB,CAACI,GAAD,CAA3D;AACD;;AACD,WAAO;AACLC,MAAAA,WAAW,EAAEF,kBADR;AAELF,MAAAA,eAAe,EAAED,iBAFZ;AAGLH,MAAAA,WAAW,EAAED;AAHR,KAAP;AAKD;;AAAA;AACD,SAAOH,KAAP;AACD,CArBD;;AAuBA,IAAMa,iBAAiB,GAAG,SAApBA,iBAAoB,CAAAC,KAAK,EAAI;AAAA,kBACCzB,QAAQ,CAAC,KAAD,CADT;AAAA;AAAA,MAC1B0B,SAD0B;AAAA,MACfC,YADe;;AAAA,mBAER3B,QAAQ,EAFA;AAAA;AAAA,MAE1B4B,KAF0B;AAAA,MAEpBC,QAFoB;;AAGjC,MAAMC,MAAM,GAAGL,KAAK,CAACM,UAAN,CAAiBC,QAAjB,CAA0B,WAA1B,CAAf;AACA,MAAMC,aAAa,GAAG9B,WAAW,CAAC,UAAAQ,KAAK;AAAA,WACrCA,KAAK,CAACuB,QAAN,CAAeC,YAAf,CAA4BC,IAA5B,CAAiC,UAAAC,IAAI;AAAA,aAAIA,IAAI,CAACC,EAAL,KAAYR,MAAhB;AAAA,KAArC,CADqC;AAAA,GAAN,CAAjC;AAGA,MAAMS,QAAQ,GAAGnC,WAAW,EAA5B;;AAPiC,oBASML,UAAU,CAACW,WAAD,EAAc;AAC7DK,IAAAA,WAAW,EAAE;AACXyB,MAAAA,KAAK,EAAEP,aAAa,GAAGA,aAAa,CAACO,KAAjB,GAAyB,EADlC;AAEXC,MAAAA,QAAQ,EAAER,aAAa,GAAGA,aAAa,CAACQ,QAAjB,GAA4B,EAFxC;AAGXC,MAAAA,WAAW,EAAET,aAAa,GAAGA,aAAa,CAACS,WAAjB,GAA+B,EAH9C;AAIXC,MAAAA,KAAK,EAAE;AAJI,KADgD;AAO7DxB,IAAAA,eAAe,EAAC;AACdqB,MAAAA,KAAK,EAAEP,aAAa,GAAG,IAAH,GAAU,KADhB;AAEdQ,MAAAA,QAAQ,EAAER,aAAa,GAAG,IAAH,GAAU,KAFnB;AAGdS,MAAAA,WAAW,EAAET,aAAa,GAAG,IAAH,GAAU,KAHtB;AAIdU,MAAAA,KAAK,EAAEV,aAAa,GAAG,IAAH,GAAU;AAJhB,KAP6C;AAa7DV,IAAAA,WAAW,EAAEU,aAAa,GAAG,IAAH,GAAU;AAbyB,GAAd,CAThB;AAAA;AAAA,MAS1BW,SAT0B;AAAA,MASfC,iBATe;;AAyBjC/C,EAAAA,SAAS,CAAC,YAAM;AACd,QAAG8B,KAAH,EAAU;AACRkB,MAAAA,KAAK,CAACC,KAAN,CAAY,kBAAZ,EAAgCnB,KAAhC,EAAuC,CAAC;AAACoB,QAAAA,IAAI,EAAE;AAAP,OAAD,CAAvC;AACD;AACF,GAJQ,EAIN,CAACpB,KAAD,CAJM,CAAT;AAMA,MAAMqB,aAAa,GAAGpD,WAAW,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA,gBAC5B+C,SAAS,CAACrB,WADkB;AAAA;AAAA;AAAA;;AAE9BuB,YAAAA,KAAK,CAACC,KAAN,CAAY,aAAZ,EAA2B,qCAA3B,EAAkE,CAChE;AAACC,cAAAA,IAAI,EAAE;AAAP,aADgE,CAAlE;AAF8B;;AAAA;AAOhCnB,YAAAA,QAAQ,CAAC,IAAD,CAAR;AACAF,YAAAA,YAAY,CAAC,IAAD,CAAZ;AARgC;;AAAA,iBAU1BM,aAV0B;AAAA;AAAA;AAAA;;AAAA;AAAA,6CAWtBM,QAAQ,CACZjC,eAAe,CAAC4C,aAAhB,CAA8BpB,MAA9B,EAAsCc,SAAS,CAAC7B,WAAV,CAAsByB,KAA5D,EAAmEI,SAAS,CAAC7B,WAAV,CAAsB2B,WAAzF,EAAsGE,SAAS,CAAC7B,WAAV,CAAsB0B,QAA5H,CADY,CAXc;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,6CAetBF,QAAQ,CACZjC,eAAe,CAAC6C,aAAhB,CAA8BP,SAAS,CAAC7B,WAAV,CAAsByB,KAApD,EAA2DI,SAAS,CAAC7B,WAAV,CAAsB2B,WAAjF,EAA8FE,SAAS,CAAC7B,WAAV,CAAsB0B,QAApH,EAA8H,CAACG,SAAS,CAAC7B,WAAV,CAAsB4B,KAArJ,CADY,CAfc;;AAAA;AAmB9BlB,YAAAA,KAAK,CAACM,UAAN,CAAiBqB,MAAjB;AAnB8B;AAAA;;AAAA;AAAA;AAAA;AAqB9BvB,YAAAA,QAAQ,CAAC,YAAIwB,OAAL,CAAR;;AArB8B;AAwBhC1B,YAAAA,YAAY,CAAC,KAAD,CAAZ;;AAxBgC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAD,EAyB9B,CAACY,QAAD,EAAWT,MAAX,EAAmBc,SAAnB,CAzB8B,CAAjC;AA2BA9C,EAAAA,SAAS,CAAC,YAAM;AACd2B,IAAAA,KAAK,CAACM,UAAN,CAAiBuB,SAAjB,CAA2B;AAAEC,MAAAA,MAAM,EAAEN;AAAV,KAA3B;AACD,GAFQ,EAEN,CAACA,aAAD,CAFM,CAAT;AAIA,MAAMO,mBAAmB,GAAG3D,WAAW,CAAC,UAAC4D,eAAD,EAAkBC,UAAlB,EAA8BC,aAA9B,EAAgD;AACtFd,IAAAA,iBAAiB,CAAC;AAChBhC,MAAAA,IAAI,EAAEJ,iBADU;AAEhBQ,MAAAA,KAAK,EAAEyC,UAFS;AAGhBtC,MAAAA,OAAO,EAAEuC,aAHO;AAIhB3C,MAAAA,KAAK,EAAEyC;AAJS,KAAD,CAAjB;AAMD,GAPsC,EAOpC,CAACZ,iBAAD,CAPoC,CAAvC;;AASA,MAAGnB,SAAH,EAAc;AACZ,WAAO,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAEkC,MAAM,CAACC,QAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA8B,oBAAC,iBAAD;AAAmB,MAAA,IAAI,EAAC,OAAxB;AAAgC,MAAA,KAAK,EAAErD,MAAM,CAACsD,OAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAA9B,CAAP;AACD;;AAED,SACE,oBAAC,oBAAD;AAAsB,IAAA,KAAK,EAAE;AAACC,MAAAA,IAAI,EAAC;AAAN,KAA7B;AAAuC,IAAA,QAAQ,EAAC,SAAhD;AAA0D,IAAA,sBAAsB,EAAE,GAAlF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEH,MAAM,CAACI,IAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,KAAD;AACE,IAAA,EAAE,EAAC,OADL;AAEE,IAAA,KAAK,EAAC,OAFR;AAGE,IAAA,SAAS,EAAC,6BAHZ;AAIE,IAAA,YAAY,EAAC,SAJf;AAKE,IAAA,cAAc,EAAC,WALjB;AAME,IAAA,WAAW,MANb;AAOE,IAAA,aAAa,EAAC,MAPhB;AAQE,IAAA,aAAa,EAAER,mBARjB;AASE,IAAA,YAAY,EAAEvB,aAAa,GAAGA,aAAa,CAACO,KAAjB,GAAyB,EATtD;AAUE,IAAA,cAAc,EAAE,CAAC,CAACP,aAVpB;AAWE,IAAA,QAAQ,MAXV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAcE,oBAAC,KAAD;AACE,IAAA,EAAE,EAAC,UADL;AAEE,IAAA,KAAK,EAAC,WAFR;AAGE,IAAA,SAAS,EAAC,iCAHZ;AAIE,IAAA,YAAY,EAAC,SAJf;AAKE,IAAA,aAAa,EAAC,MALhB;AAME,IAAA,aAAa,EAAEuB,mBANjB;AAOE,IAAA,YAAY,EAAEvB,aAAa,GAAGA,aAAa,CAACQ,QAAjB,GAA4B,EAPzD;AAQE,IAAA,cAAc,EAAE,CAAC,CAACR,aARpB;AASE,IAAA,QAAQ,MATV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAdF,EAyBGA,aAAa,GAAG,IAAH,GACZ,oBAAC,KAAD;AACA,IAAA,EAAE,EAAC,OADH;AAEA,IAAA,KAAK,EAAC,OAFN;AAGA,IAAA,SAAS,EAAC,6BAHV;AAIA,IAAA,YAAY,EAAC,aAJb;AAKA,IAAA,aAAa,EAAC,MALd;AAMA,IAAA,aAAa,EAAEuB,mBANf;AAOA,IAAA,QAAQ,MAPR;AAQA,IAAA,GAAG,EAAE,GARL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IA1BJ,EAqCE,oBAAC,KAAD;AACE,IAAA,EAAE,EAAC,aADL;AAEE,IAAA,KAAK,EAAC,aAFR;AAGE,IAAA,SAAS,EAAC,mCAHZ;AAIE,IAAA,YAAY,EAAC,SAJf;AAKE,IAAA,cAAc,EAAC,WALjB;AAME,IAAA,aAAa,EAAEA,mBANjB;AAOE,IAAA,WAAW,MAPb;AAQE,IAAA,SAAS,MARX;AASE,IAAA,aAAa,EAAE,CATjB;AAUE,IAAA,YAAY,EAAEvB,aAAa,GAAGA,aAAa,CAACS,WAAjB,GAA+B,EAV5D;AAWE,IAAA,cAAc,EAAE,CAAC,CAACT,aAXpB;AAYE,IAAA,QAAQ,MAZV;AAaE,IAAA,SAAS,EAAE,CAbb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IArCF,CADF,CADF,CADF;AA2DD,CAtID;;AAwIAT,iBAAiB,CAACyC,iBAAlB,GAAsC,UAAAC,OAAO,EAAI;AAC/C,MAAMC,QAAQ,GAAGD,OAAO,CAACnC,UAAR,CAAmBC,QAAnB,CAA4B,QAA5B,CAAjB;AACA,SAAO;AACLoC,IAAAA,WAAW,EAAEF,OAAO,CAACnC,UAAR,CAAmBC,QAAnB,CAA4B,WAA5B,IACT,cADS,GAET,aAHC;AAILqC,IAAAA,WAAW,EAAE;AAAA,aACX,oBAAC,aAAD;AAAe,QAAA,qBAAqB,EAAEhE,YAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,IAAD;AACE,QAAA,KAAK,EAAC,MADR;AAEE,QAAA,QAAQ,EACNiE,QAAQ,CAACC,EAAT,KAAgB,SAAhB,GAA4B,cAA5B,GAA6C,eAHjD;AAKE,QAAA,OAAO,EAAEJ,QALX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CADW;AAAA;AAJR,GAAP;AAgBD,CAlBD;;AAoBA,IAAMP,MAAM,GAAGY,UAAU,CAACC,MAAX,CAAkB;AAC/BT,EAAAA,IAAI,EAAE;AACJU,IAAAA,MAAM,EAAE;AADJ,GADyB;AAI/Bb,EAAAA,QAAQ,EAAE;AACRE,IAAAA,IAAI,EAAE,CADE;AAERY,IAAAA,cAAc,EAAE,QAFR;AAGRC,IAAAA,UAAU,EAAE;AAHJ;AAJqB,CAAlB,CAAf;AAWA,eAAepD,iBAAf","sourcesContent":["import React,{useCallback,useEffect,useReducer,useState} from 'react';\r\nimport {View,ScrollView,StyleSheet,Platform, Alert,KeyboardAvoidingView,ActivityIndicator} from 'react-native';\r\nimport { HeaderButtons, Item } from 'react-navigation-header-buttons';\r\nimport {useSelector,useDispatch} from 'react-redux';\r\n\r\nimport HeaderButton from '../../components/UI/HeaderButton';\r\nimport * as productsActions from '../../store/actions/products';\r\nimport Input from '../../components/UI/Input';\r\nimport Colors from '../../constants/Colors';\r\n\r\nconst FORM_INPUT_UPDATE = 'FORM_INPUT_UPDATE';\r\n\r\nconst formReducer = (state, action) => {\r\n  if(action.type === FORM_INPUT_UPDATE ) {\r\n    const updatedValues = {\r\n      ...state.inputValues,\r\n      [action.input]: action.value\r\n    };\r\n    const updatedValidities= {\r\n      ...state.inputValidities,\r\n      [action.input]: action.isValid\r\n    };\r\n    let updatedFormIsValid = true;\r\n    for(const key in updatedValidities) {\r\n      updatedFormIsValid = updatedFormIsValid &&updatedValidities[key];\r\n    }\r\n    return {\r\n      formIsValid: updatedFormIsValid,\r\n      inputValidities: updatedValidities,\r\n      inputValues: updatedValues\r\n    };\r\n  };\r\n  return state;\r\n};\r\n\r\nconst EditProductScreen = props => {\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error,setError] = useState();\r\n  const prodId = props.navigation.getParam('productId');\r\n  const editedProduct = useSelector(state =>\r\n    state.products.userProducts.find(prod => prod.id === prodId)\r\n  );\r\n  const dispatch = useDispatch();\r\n\r\n  const [formState, dispatchFormState] = useReducer(formReducer, {\r\n    inputValues: {\r\n      title: editedProduct ? editedProduct.title : '',\r\n      imageUrl: editedProduct ? editedProduct.imageUrl : '',\r\n      description: editedProduct ? editedProduct.description : '',\r\n      price: ''\r\n    }, \r\n    inputValidities:{\r\n      title: editedProduct ? true : false,\r\n      imageUrl: editedProduct ? true : false,\r\n      description: editedProduct ? true : false,\r\n      price: editedProduct ? true : false\r\n    },\r\n    formIsValid: editedProduct ? true : false \r\n  })\r\n\r\n  useEffect(() => {\r\n    if(error) {\r\n      Alert.alert('An error occured', error, [{text: 'Okay' }]);\r\n    }\r\n  }, [error]);\r\n\r\n  const submitHandler = useCallback(async () => {\r\n    if(!formState.formIsValid) {\r\n      Alert.alert('Wrong input', 'Please check the errors in the form', [\r\n        {text: 'Okay'}\r\n      ]);\r\n      return;\r\n    }\r\n    setError(null);\r\n    setIsLoading(true);\r\n    try {\r\n      if (editedProduct) {\r\n        await dispatch(\r\n          productsActions.updateProduct(prodId, formState.inputValues.title, formState.inputValues.description, formState.inputValues.imageUrl)\r\n        );\r\n      } else {\r\n        await dispatch(\r\n          productsActions.createProduct(formState.inputValues.title, formState.inputValues.description, formState.inputValues.imageUrl, +formState.inputValues.price)\r\n        );\r\n      }\r\n      props.navigation.goBack();\r\n    } catch (err) {\r\n      setError(err.message);\r\n    }\r\n   \r\n    setIsLoading(false);\r\n  }, [dispatch, prodId, formState]);\r\n\r\n  useEffect(() => {\r\n    props.navigation.setParams({ submit: submitHandler });\r\n  }, [submitHandler]);\r\n\r\n  const inputChangedHandler = useCallback((inputIdentifier, inputValue, inputValidity) => {\r\n    dispatchFormState({\r\n      type: FORM_INPUT_UPDATE, \r\n      value: inputValue, \r\n      isValid: inputValidity,\r\n      input: inputIdentifier\r\n    });\r\n  }, [dispatchFormState]);\r\n\r\n  if(isLoading) {\r\n    return <View style={styles.centered}><ActivityIndicator size=\"large\" color={Colors.primary} /></View>\r\n  }\r\n\r\n  return (\r\n    <KeyboardAvoidingView style={{flex:1}} behavior=\"padding\" keyboardVerticalOffset={100}>\r\n      <ScrollView>\r\n        <View style={styles.form}>\r\n          <Input    \r\n            id='title'   \r\n            label='Title'  \r\n            errorText=\"Please enter a valid title!\"\r\n            keyboardType='default'\r\n            autoCapitalize='sentences'\r\n            autoCorrect\r\n            returnKeyType='next'  \r\n            onInputChange={inputChangedHandler}\r\n            initialValue={editedProduct ? editedProduct.title : ''}\r\n            initiallyValid={!!editedProduct}\r\n            required\r\n          />\r\n          <Input       \r\n            id='imageUrl'\r\n            label='Image Url'  \r\n            errorText=\"Please enter a valid image URL!\"\r\n            keyboardType='default'\r\n            returnKeyType='next'  \r\n            onInputChange={inputChangedHandler}\r\n            initialValue={editedProduct ? editedProduct.imageUrl : ''}\r\n            initiallyValid={!!editedProduct}\r\n            required\r\n          />\r\n          {editedProduct ? null : (\r\n            <Input       \r\n            id='price'\r\n            label='Price'  \r\n            errorText=\"Please enter a valid price!\"\r\n            keyboardType='decimal-pad'\r\n            returnKeyType='next'\r\n            onInputChange={inputChangedHandler}  \r\n            required\r\n            min={0.1}\r\n          />\r\n          )}\r\n          <Input       \r\n            id='description'\r\n            label='Description'  \r\n            errorText=\"Please enter a valid description!\"\r\n            keyboardType='default'\r\n            autoCapitalize='sentences'\r\n            onInputChange={inputChangedHandler}\r\n            autoCorrect\r\n            multiline\r\n            numberOfLines={3}\r\n            initialValue={editedProduct ? editedProduct.description : ''}\r\n            initiallyValid={!!editedProduct}\r\n            required\r\n            minLength={5}\r\n          />\r\n        </View>\r\n      </ScrollView>\r\n    </KeyboardAvoidingView>\r\n  );\r\n};\r\n\r\nEditProductScreen.navigationOptions = navData => {\r\n  const submitFn = navData.navigation.getParam('submit');\r\n  return {\r\n    headerTitle: navData.navigation.getParam('productId')\r\n      ? 'Edit Product'\r\n      : 'Add Product',\r\n    headerRight: () => (\r\n      <HeaderButtons HeaderButtonComponent={HeaderButton}>\r\n        <Item\r\n          title=\"Save\"\r\n          iconName={\r\n            Platform.OS === 'android' ? 'md-checkmark' : 'ios-checkmark'\r\n          }\r\n          onPress={submitFn}\r\n        />\r\n      </HeaderButtons>\r\n    )\r\n  };\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  form: {\r\n    margin: 20\r\n  },\r\n  centered: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center'\r\n  }\r\n});\r\n\r\nexport default EditProductScreen;\r\n"]},"metadata":{},"sourceType":"module"}